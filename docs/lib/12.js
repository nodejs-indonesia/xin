(window.webpackJsonp=window.webpackJsonp||[]).push([[12],[,,function(e,t,i){"use strict";i.r(t);var s=i(1),n=i(0);i(32);class r extends s.a{get props(){const e=this.__repository.get("view.transitionIn")||this.__repository.get("view.transition")||"slide",t=this.__repository.get("view.transitionOut")||this.__repository.get("view.transition")||"fade";return Object.assign({},super.props,{uri:{type:String,required:!0},transitionIn:{type:String,value:e},transitionOut:{type:String,value:t},index:{type:Number,value:0}})}focusing(){}focused(){}blurred(){}created(){super.created(),this.classList.add("xin-view")}ready(){super.ready(),this.inFx=new n.a({element:this,transition:this.transitionIn,method:"in"}),this.outFx=new n.a({element:this,transition:this.transitionOut,method:"out"})}attached(){super.attached(),this.classList.remove("xin-view--focus"),this.classList.remove("xin-view--visible"),this.__app?(this.__app.route(this.uri,e=>{this.focus(e)}),this.fire("routed")):console.error("Cannot route view to undefined app")}async focus(e={}){this.set("parameters",e),await this.focusing(e),this.fire("focusing",e),this.async(()=>{"setFocus"in this.parentElement?this.parentElement.setFocus(this):(this.setVisible(!0),this.setFocus(!0))})}setVisible(e){if(e)return this.classList.add("xin-view--visible"),void this.fire("show",{view:this});this.classList.remove("xin-view--visible"),[].forEach.call(this.querySelectorAll(".xin-view.xin-view--visible"),t=>t.setVisible(e)),this.fire("hide")}async setFocus(e){if(e)return this.classList.add("xin-view--focus"),await this.focused(),void this.fire("focus");this.classList.remove("xin-view--focus"),[].forEach.call(this.querySelectorAll(".xin-view.xin-view--focus"),t=>{"setFocus"in t.parentElement?t.parentElement.setFocus(null):t.setFocus(e)}),await this.blurred(),this.fire("blur")}}Object(s.d)("xin-view",r),i.d(t,"View",function(){return r})},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";i.r(t);var s=i(5),n=i(0),r=i(1);class a{static routeRegExp(e){let t=e.split("[");if(t.length>2)throw new Error("Invalid use of optional params");let i=[],s=t[0].replace(/{([^}]+)}/g,function(e,t){return i.push(t),"([^/]+)"}).replace(/\//g,"\\/"),n="";return t[1]&&(n="(?:"+t[1].slice(0,-1).replace(/{([^}]+)}/g,function(e,t){let[s,n="[^/]+"]=t.split(":");return i.push(s),`(${n})`}).replace(/\//g,"\\/")+")?"),[new RegExp("^"+s+n+"$"),i]}static isStatic(e){return!e.match(/[[{]/)}constructor(e,t){if(this.route=e,this.callback=t,a.isStatic(e))this.type="s",this.pattern=null,this.args=[];else{let t=a.routeRegExp(e);this.type="v",this.pattern=t[0],this.args=t[1]}}getExecutorFor(e){if("s"===this.type){if(e===this.route)return{handler:this,args:{}}}else if("v"===this.type){let t=e.match(this.pattern);if(t)return{handler:this,args:this.args.reduce((e,i,s)=>(e[i]=t[s+1],e),{})}}}}i(41);const o=i(6)("xin:components:app");class l extends r.a{get props(){return{title:{type:String,observer:"_titleChanged"},manual:{type:Boolean},mode:{type:String,value:"hash"},rootUri:{type:String,value:"/"},hash:{type:String,value:"#!"},delay:{type:Number,value:1}}}get hashRegexp(){return this._hashRegexp&&this._hash===this.hash||(this._hashRegexp=new RegExp(`${this.hash}(.*)$`),this._hash=this.hash),this._hashRegexp}notFound(e){console.warn(`Route not found: ${e}`)}_titleChanged(e){e&&(document.title=e)}created(){this.__appSignature=!0,this.location=window.location,this.history=window.history,this.handlers=[],this.middlewares=[],this.__started=!1,this.__starting=!1,this.classList.add("xin-app")}attached(){this.manual||this.async(()=>{this.start()},this.delay)}route(e,t){this.handlers.push(new a(e,t))}async start(){if(this.__started||this.__starting)return;this.__middlewareChainRun=function(e){for(let t of e)if("function"!=typeof t)throw new TypeError("Middleware must be composed of functions!");return(t,i)=>{let s=-1;return function n(r){if(r<=s)throw new Error("next() called multiple times");s=r;let a=e[r];r===e.length&&(a=i);if(!a)return;return a(t,()=>n(r+1))}(0)}}(this.middlewares),this.__listenNavigation(),o(`Starting ${this.is}:${this.__id} ...`),this.__starting=!0;let e=await this.__execute();this.__starting=!1,e&&(o(`Started ${this.is}:${this.__id}`),this.__started=!0,this.fire("started"))}__listenNavigation(){let e=()=>{this.__execute()};"history"===this.mode?(Object(n.e)(window).on("popstate",e),Object(n.e)(document).on("click",t=>{if(!t.defaultPrevented&&"A"===t.target.nodeName&&""===t.target.target){t.preventDefault();let i={url:t.target.getAttribute("href")};this.history.pushState(i,t.target.innerHTML,t.target.href),e()}})):Object(n.e)(window).on("hashchange",e)}get started(){return this.__started||!1}getFragmentExecutors(e){return this.handlers.reduce((t,i)=>{let s=i.getExecutorFor(e);return s&&t.push(s),t},[])}async __execute(){let e=this.getFragment(),t={app:this,uri:e};return!1!==await this.__middlewareChainRun(t,()=>{let i=this.getFragmentExecutors(t.uri);if(0===i.length)return this.notFound(e),void this.fire("route-not-found",e);i.forEach(e=>{e.handler.callback(e.args,t)})})&&(this.fire("navigated",t),!0)}navigate(e,t){if(e=e||"/",t=t||{},"history"===this.mode){let i=this.rootUri+e.toString().replace(/\/$/,"").replace(/^\//,"");this.location.href.replace(this.location.origin,"")!==i&&(this.history[t.replace?"replaceState":"pushState"]({},document.title,i),this.__execute())}else t.replace?this.location.replace(this.hash+e):this.location.hash=this.hash+e;return this}use(e){this.middlewares.push(e)}getFragment(){try{let e;if("history"===this.mode)e=(e=decodeURI(this.location.pathname+this.location.search)).replace(/\?(.*)$/,""),e="/"===this.rootUri?e:e.replace(this.rootUri,"");else{let t=this.location.href.match(this.hashRegexp);e=t?t[1]:""}return"/"+e.toString().replace(/\/$/,"").replace(/^\//,"")}catch(e){return console.error("Fragment is not match any pattern, fallback to /"),"/"}}}Object(r.d)("xin-app",l);class h extends r.a{static create(e,t={}){const i=`\n      <xin-fixture>\n        <template>\n          ${e}\n        </template>\n      </xin-fixture>\n    `,s=document.createElement("div");s.innerHTML=i;const n=s.querySelector("xin-fixture");return n.__initialData=t,document.body.appendChild(n),n}attached(){super.attached(),this.connected=!0;for(let e in this.__initialData)this.set(e,this.__initialData[e]);this.async(()=>{this.fire("connected")})}detached(){super.detached(),this.connected=!1,this.fire("disconnected")}dispose(){this.parentElement.removeChild(this),this.connected=!1}async waitConnected(e){await new Promise(e=>{this.connected?e():this.once("connected",e)}),await this.wait(e)}wait(e=0){return new Promise(t=>{this.async(t,e)})}async waitDisconnected(e){await new Promise(e=>{this.connected?this.once("disconnected",e):e()}),await this.wait(e)}}Object(r.d)("xin-fixture",h);class d extends r.a{attached(){super.attached(),this.__app.use(this.callback())}}i(39);class c extends r.a{ready(){super.ready();for(let e=this.firstElementChild,t=0;e;e=e.nextElementSibling,t++)"set"in e?e.set("index",t):e.setAttribute("index",t)}setFocus(e){if(e){let t=e.index,i=this.focused$?this.focused$.index:-1;i<t?this.__transitionForward(this.focused$,e):i>t&&this.__transitionBackward(this.focused$,e)}else this.focused$&&this.focused$.setFocus(!1);this.focused$=e}__transitionBackward(e,t){Promise.all([t.inFx.play(-1),e.outFx.play(-1)]).then(()=>{e.setVisible(!1),t.setVisible(!0),e.setFocus(!1),t.setFocus(!0),this.$focused=t,t.inFx.stop(),e.outFx.stop()})}__transitionForward(e,t){if(e)Promise.all([t.inFx.play(1),e.outFx.play(1)]).then(()=>{e.setVisible(!1),t.setVisible(!0),e.setFocus(!1),t.setFocus(!0),this.$focused=t,t.inFx.stop(),e.outFx.stop()});else{let e=new n.a({element:t,transition:"none"});e.play("in",1).then(()=>{t.setVisible(!0),t.setFocus(!0),this.$focused=t,e.stop()})}}}Object(r.d)("xin-pager",c);class p extends r.b{constructor(e,t,i,s){super(),this.__templateInitialize(e,t.__templateModel,t.__templateMarker),this.is="$repeat-row",this.__id=this.__templateId,this.__repeat=t,this.__repeatAs=t.as,this.__repeatIndexAs=t.indexAs,this.__templateChildNodes.forEach(e=>{e.nodeType===window.Node.ELEMENT_NODE&&(e.__repeatModel=this)}),this.update(i,s),this.__templateRender()}get __app(){return this.__templateHost.__app}update(e,t){this[this.__repeatAs]=e,this[this.__repeatIndexAs]=t,this.notify(this.__repeatAs,e),this.notify(this.__repeatIndexAs,t)}set(e,t){return(e=this.__templateGetPathAsArray(e))[0]===this.__repeatAs||e[0]===this.__repeatIndexAs?super.set(e,t):this.__templateHost.set(e,t)}get(e){return(e=this.__templateGetPathAsArray(e))[0]===this.__repeatAs||e[0]===this.__repeatIndexAs?super.get(e):this.__templateHost.get(e)}notify(e,t){return(e=this.__templateGetPathAsArray(e))[0]===this.__repeatAs||e[0]===this.__repeatIndexAs?super.notify(e,t):this.__templateHost.notify(e,t)}}i(37);const u=()=>!0;class _ extends r.a{get props(){return Object.assign({},super.props,{items:{type:Array,observer:"_itemsChanged(items, filter)"},as:{type:String,value:"item"},indexAs:{type:String,value:"index"},filter:{type:Function,observer:"_itemsChanged(items, filter)"},to:{type:String,value:""}})}created(){super.created(),this.rows=[]}__initTemplate(){if(this.__templateFor=this.firstElementChild,!this.__templateFor)throw new Error('Invalid xin-for definition, must be <xin-for items="[[items]]"><template>...</template></xin-for>');this.removeChild(this.__templateFor);let e=this,t=this.getAttribute("to");if(t){let i=document.querySelector(t);if(!i)throw new Error(`xin-for render to unknown element ${t}`);e=document.createComment("marker-for"),i.appendChild(e)}r.b.prototype.__templateInitialize.call(this,null,this,e)}_itemsChanged(e,t){this.debounce("_itemsChanged",()=>{let t=0;if(e&&e.length){let i=this.filter||u;e.filter(i).forEach((e,i)=>{this.rows[i]?this.rows[i].update(e,i):this.rows.push(new p(this.__templateFor,this,e,i)),t++})}this.rows.splice(t).forEach(e=>{e.__templateUninitialize()})})}itemForElement(e){for(;e&&!e.__repeatModel;)e=e.parentElement;return e.__repeatModel.get(this.as)}indexForElement(e){for(;e&&!e.__repeatModel;)e=e.parentElement;return e.__repeatModel.get(this.indexAs)}modelForElement(e){for(;e&&!e.__repeatModel;)e=e.parentElement;return e.__repeatModel}}Object(r.d)("xin-for",_);const m=()=>!0;class f extends(Object(r.c)("HTMLTemplateElement")){get props(){return Object.assign({},super.props,{items:{type:Array,observer:"_itemsChanged(items, filter)"},as:{type:String,value:"item"},indexAs:{type:String,value:"index"},filter:{type:Function,observer:"_itemsChanged(items, filter)"}})}created(){super.created(),Object(n.d)("components/repeat","Please use xin-for instead"),this.rows=[]}__initTemplate(){r.b.prototype.__templateInitialize.call(this,null,this)}_itemsChanged(e,t){this.debounce("_itemsChanged",()=>{let t=0;if(e&&e.length){let i=this.filter||m;e.filter(i).forEach((e,i)=>{this.rows[i]?this.rows[i].update(e,i):this.rows.push(new p(this,this,e,i)),t++})}this.rows.splice(t).forEach(e=>{e.__templateUninitialize()})})}itemForElement(e){for(;e&&!e.__repeatModel;)e=e.parentElement;return e.__repeatModel.get(this.as)}indexForElement(e){for(;e&&!e.__repeatModel;)e=e.parentElement;return e.__repeatModel.get(this.indexAs)}modelForElement(e){for(;e&&!e.__repeatModel;)e=e.parentElement;return e.__repeatModel}}Object(r.d)("xin-repeat",f,{extends:"template"});i(2);class w{constructor(e,t,i){this.name=t.nodeName.toLowerCase(),this.uri=t.getAttribute("uri"),this.element=t,this.loader=i,this.route=new a(this.uri),this.isStaticRoute=a.isStatic(this.uri),this.bag=e}get loaded(){if(this._loaded)return!0;return this.element.classList.contains("xin-view")?(this._loaded=!0,!0):void 0}load(){return new Promise((e,t)=>this.loaded?e():this.loader?(Object(n.e)(this.element).once("routed",()=>{this._loaded=!0,this.element.querySelector(".xin-view")?setTimeout(()=>e(),300):e()}),void this.loader.load(this)):t(new Error(`Cannot lazy load view: ${this.name}`)))}}Object(r.d)("xin-lazy-view-middleware",class extends d{get props(){return Object.assign({},super.props,{loaders:{type:Array,value:()=>this.__repository.get("view.loaders")?this.__repository.get("view.loaders"):this.__repository.get("viewLoaders")?(Object(n.d)("",'Do not use configuration "viewLoaders". Please use "view.loaders" instead.'),this.__repository.get("viewLoaders")):[]}})}created(){super.created(),this.views=[]}attached(){super.attached(),this.loaders.push({test:/^xin-/,load(e){if("xin-view"===e.name)return Promise.resolve().then(i.bind(null,2))}})}get(e){let t=this.views.find(t=>t.uri===e);return t||this.views.find(t=>!(!t.isStaticRoute||t.uri!==e)||t.route.getExecutorFor(e))}put(e){this.views.push(e)}ensure(e,t){0===this.views.length&&[].forEach.call(e.querySelectorAll("[lazy-view]"),e=>{let t=this.loaders.find(t=>e.nodeName.toLowerCase().match(t.test)),i=new w(this,e,t);this.put(i)});let i=this.get(t);if(!i)throw new Error("Unknown view for "+t);return i.load()}callback(e){const t=this;return async function(e,i){await t.ensure(e.app,e.uri),await i()}}});Object(r.d)("xin-title-middleware",class extends d{get props(){return Object.assign({},super.props,{defaultTitle:{type:String,value:"Unknown"}})}callback(e){const t=this;return async function(e,i){e.app.once("focus",e=>{document.title=e.target.title||t.defaultTitle}),await i()}}});i(35);Object(s.b)("x-redirect-middleware",class extends d{callback(e){return async function(e,t){-1===[...document.querySelector("xin-pager").children].map(e=>e.getAttribute("uri")).indexOf(e.uri)&&(e.uri="/not-found"),await t()}}});Object(s.b)("x-app",class extends l{get template(){return i(33)}})},function(e,t,i){(e.exports=i(9)(!1)).push([e.i,".xin-view {\n  box-sizing: border-box;\n  display: none;\n}\n\n.xin-view.xin-view--visible {\n  display: block;\n}\n",""])},function(e,t,i){var s=i(31);"string"==typeof s&&(s=[[e.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};i(8)(s,n);s.locals&&(e.exports=s.locals)},function(e,t){e.exports='<x-redirect-middleware></x-redirect-middleware>\n<xin-lazy-view-middleware></xin-lazy-view-middleware>\n\n<xin-pager>\n  <xin-view lazy-view uri="/">\n    <template>\n      <div class="padding">\n        <h1>xin</h1>\n\n        <p>A WebComponents based framework. We love npm, webpack and ofcourse webcomponents specs.</p>\n\n        <div class="list">\n          <a href="#!/intro">Intro</a>\n          <a href="#!/binding">Binding</a>\n          <a href="#!/app-route">App, views and routing</a>\n          <a href="#!/component">Component</a>\n          <a href="#!/middleware">Middleware</a>\n          <div class="list__separator">Components</div>\n          <a href="#!/fixture">xin-fixture</a>\n          <a href="#!/for">xin-for</a>\n          <div class="list__separator">Advanced</div>\n          <a href="#!/advanced">Advanced topics</a>\n        </div>\n      </div>\n    </template>\n  </xin-view>\n  <x-intro lazy-view uri="/intro"></x-intro>\n  <x-binding lazy-view uri="/binding"></x-binding>\n  <x-app-route lazy-view uri="/app-route"></x-app-route>\n  <x-component lazy-view uri="/component"></x-component>\n  <x-middleware lazy-view uri="/middleware"></x-middleware>\n  <x-for lazy-view uri="/for"></x-for>\n\n  <xin-view lazy-view uri="/advanced">\n    <div class="padding">\n      <h2>Advanced topics</h2>\n\n      <h3>Defer</h3>\n\n      <ul>\n        <li>Async</li>\n        <li>Debounce</li>\n        <li>NextFrame</li>\n      </ul>\n\n      <h3>Events</h3>\n\n      <ul>\n        <li>component.fire()</li>\n        <li>component.on()</li>\n      </ul>\n\n    </div>\n  </xin-view>\n\n  <xin-view lazy-view uri="/not-found">\n    <div class="aligner">\n      <div class="aligner-item">\n        <p>\n          Oops, route not found. Sorry...\n        </p>\n        <a href="#!/">Home</a>\n      </div>\n    </div>\n  </xin-view>\n</xin-pager>\n'},function(e,t,i){(e.exports=i(9)(!1)).push([e.i,"code {\n  margin-bottom: 10px;\n}\n\n.card {\n  padding: 16px;\n  border: 1px solid #999;\n  border-radius: 4px;\n}\n\n.aligner {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n}\n\n.aligner-item {\n  max-width: 50%;\n  text-align: center;\n}\n",""])},function(e,t,i){var s=i(34);"string"==typeof s&&(s=[[e.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};i(8)(s,n);s.locals&&(e.exports=s.locals)},function(e,t,i){(e.exports=i(9)(!1)).push([e.i,"xin-for {\n  display: none;\n  visibility: hidden;\n}\n",""])},function(e,t,i){var s=i(36);"string"==typeof s&&(s=[[e.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};i(8)(s,n);s.locals&&(e.exports=s.locals)},function(e,t,i){(e.exports=i(9)(!1)).push([e.i,"xin-pager {\n  box-sizing: border-box;\n  display: block;\n  position: relative;\n  overflow: hidden;\n  height: 100%;\n}\n\nxin-pager .xin-view {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n",""])},function(e,t,i){var s=i(38);"string"==typeof s&&(s=[[e.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};i(8)(s,n);s.locals&&(e.exports=s.locals)},function(e,t,i){(e.exports=i(9)(!1)).push([e.i,".xin-app {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n}\n",""])},function(e,t,i){var s=i(40);"string"==typeof s&&(s=[[e.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};i(8)(s,n);s.locals&&(e.exports=s.locals)}]]);